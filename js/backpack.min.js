/*!
 * backpack v0.0.3 (https://github.com/docluv/backpack)
 * Copyright 2013-2014 Chris Love
 * Licensed under Apache (https://github.com/docluv/backpack/LICENSE)
 */
!function(a,b){"use strict";var c=function(a){var d,e,f=new c.fn.init;for(d in f.settings)e=a[d],f.settings!==e&&e!==b&&(f.settings[d]=e);return f};return c.fn=c.prototype={constructor:c,init:function(){return this},version:"0.0.4",parseLocalStorage:function(a){var b=localStorage.getItem(a);return b?JSON.parse(b)||{}:{}},getTemplates:function(a){var b,c,d=this,e=document.querySelectorAll("script[type='"+this.settings.templateType+"']"),f=d.parseLocalStorage("templates");for(b=0;b<e.length;b++)c=e[b],f[c.id]=c.innerHTML.replace(/(\r\n|\n|\r)/gm,""),a&&c.parentNode&&c.parentNode.removeChild(c);return localStorage.setItem("templates",JSON.stringify(f)),f},getTemplate:function(a){return"<script type='"+this.settings.templateType+"'>"+localStorage.getItem(a)+"</script>"},updateViews:function(a){var b,c=document.querySelectorAll(a);for(b=0;b<c.length;b++)this.saveViewToStorage(c[b])},saveViewToStorage:function(a){"string"==typeof a&&(a=document.getElementById(a)),a&&(this.storeViewInfo(this.parseViewInfo(a)),!a.parentNode||a.className.search(this.settings.currentClass)>-1||a.parentNode.removeChild(a),a=b)},parseViewInfo:function(a){return{pageId:a.id,viewTitle:a.hasAttribute("data-title")?a.getAttribute("data-title"):this.settings.defaultTitle,tranistion:a.hasAttribute("data-transition")?a.getAttribute("data-transition"):"",content:a.outerHTML}},storeViewInfo:function(a){a=$.extend({},this.pageSettings,a),localStorage.setItem(this.settings.appName+"-"+a.pageId,JSON.stringify(a))},getViewData:function(b){var c,d=localStorage[this.settings.appName+"-"+b];return d||(c=document.getElementById(b),c&&(this.saveViewToStorage(c),d=a.localStorage[this.settings.appName+"-"+b])),d?JSON.parse(d):void 0},settings:{viewSelector:".content-pane",defaultTitle:"A Really Cool SPA App",deferredTimeKey:"lastDeferredTime",templateType:"text/x-mustache-template",currentClass:"current",appName:""},pageSettings:{pageId:"",url:"",css:b,js:b,templates:"",content:"",defaultTemplate:"#DefaultViewTemplate"}},c.fn.init.prototype=c.fn,a.backpack=c}(window);